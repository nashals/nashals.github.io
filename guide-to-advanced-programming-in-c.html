<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head><!-- <meta name="baidu-site-verification" content="707024a76f8f40b549f07f478abab237"/> -->
<title>Guide to Advanced Programming in C</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Guide to Advanced Programming in C"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2014-10-12T22:43+0800"/>
<meta name="author" content="dirtysalt"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style><link rel="shortcut icon" href="css/favicon.ico" /> <link rel="stylesheet" type="text/css" href="css/site.css" />


</head>
<body><!-- <div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare"><a class="bds_tsina"></a><span class="bds_more"></span><a class="shareCount"></a></div> --><!-- Place this tag where you want the +1 button to render --><!-- <g:plusone annotation="inline"></g:plusone> -->

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Guide to Advanced Programming in C</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="guide-to-advanced-programming-in-c.html#sec-1">1 guide-to-advanced-programming-in-c</a>
<ul>
<li><a href="guide-to-advanced-programming-in-c.html#sec-1-1">1.1 Integer Overflows and Promotions</a></li>
<li><a href="guide-to-advanced-programming-in-c.html#sec-1-2">1.2 Memory Allocation and Management</a></li>
<li><a href="guide-to-advanced-programming-in-c.html#sec-1-3">1.3 Pointers and Arrays</a></li>
<li><a href="guide-to-advanced-programming-in-c.html#sec-1-4">1.4 Interpositioning</a></li>
<li><a href="guide-to-advanced-programming-in-c.html#sec-1-5">1.5 Explicit Inlining</a></li>
<li><a href="guide-to-advanced-programming-in-c.html#sec-1-6">1.6 Vector Extensions</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> guide-to-advanced-programming-in-c</h2>
<div class="outline-text-2" id="text-1">


<p>
<a href="http://pfacka.binaryparadise.com/articles/guide-to-advanced-programming-in-C.html">http://pfacka.binaryparadise.com/articles/guide-to-advanced-programming-in-C.html</a>
</p>

</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Integer Overflows and Promotions</h3>
<div class="outline-text-3" id="text-1-1">

</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Memory Allocation and Management</h3>
<div class="outline-text-3" id="text-1-2">

<p>Many operating systems provide interface to control access over memory regions to protect memory against unintended read/write operations such as Posix <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/mprotect.html">mprotect</a> . These mechanisms usually apply to whole memory pages. (mprotect以page为单位）
</p>
<p>
<a href="http://www.cs.nyu.edu/exact/core/doc/stackOverflow.txt">http://www.cs.nyu.edu/exact/core/doc/stackOverflow.txt</a> 给出了每个平台默认stack大小以及修改方法
</p>


<pre class="example">Stack Overflow Problems
=======================
This file gives some hints on addressing this problem on different platforms.

Under Unix-like systems, programs may throw a "Segmentation Fault"
error.  This can be due to stack overflow, especially from recursive 
function calls or huge data sets.  In our demo program "Pi"
(see "$(CORE_PATH)/progs/pi"), we compute Pi to any number of desired
bits or digits.  Here are some test results on when stack overflows
will occur on different platforms, using their default stack sizes.  

        platform        default size    # bits  # digits
        ===============================================================
        SunOS/Solaris   8172K bytes     &lt;=39875 &lt;=12003 (Shared Version)
        Linux           8172K bytes     &lt;=62407 &lt;=18786
        Windows         1024K bytes     &lt;=10581 &lt;=3185  (Release Version)
        cygwin          2048K bytes     &lt;=3630  &lt;=1092
        
If we now change their stack size to their maximum, our Pi program can 
compute more bits. 

        platform        stack size      # bits          # digits
        ===============================================================
        SunOS/Solaris   unlimited       &gt;=100,000       30102
        Linux           8172K bytes     &lt;=33,219,282    &lt;=10,000,000(?)
        Windows         32768K bytes    &lt;=343077        &lt;=12041
        
How to change the default stack size on different platforms:
In general, under Unix-like platforms, the stack size is controlled 
by environment variable, not the program itself.  
So you cannot pass any flags to the 
compilers, like gcc, to setup stack size.  Under Windows platforms, the
stack size information is contained in the executable files.  It can be set 
during compilation in Visual C++, but this is not available in gcc. 
Alternatively, Microsoft provides a program "editbin.exe" which can change the
executable files directly.  Here are more details:

SunOS/Solaris:
==============
        &gt; limit                  # shows the current stack size
        &gt; unlimit                # changes the stack size to unlimited
        &gt; setenv STACKSIZE 32768 # limits the stack size to 32M bytes

Linux:
======
        &gt; ulimit -a             # shows the current stack size
        &gt; ulimit -s 32768       # sets the stack size to 32M bytes

Windows (during compilation):
=============================
        1. Select "Project-&gt;Setting".
        2. Select "Link" page.
        3. Select "Category" to "Output".
        4. Type your preferred stack size in "Reserve:" field under "Stack 
           allocations". eg, 32768 in decimal or 0x20000 in hexadecimal.

Windows (to modify the executable file):
=======================================
There are two programs included in Microsoft Visual Studio, "dumpbin.exe"
 and "editbin.exe".  Run "dumpbin /headers executable_file", and you can see 
the "size of stack reserve" information in "optional header values".  Run 
"editbin /STACK:size" to change the default stack size.

</pre>


</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Pointers and Arrays</h3>
<div class="outline-text-3" id="text-1-3">

</div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Interpositioning</h3>
<div class="outline-text-3" id="text-1-4">

<p>__attribute__ ((visibility (&lt;value&gt;))) 可以用来控制符号可见域，其中value可以指定为
</p><ul>
<li>"default" # 对其他单元可见
</li>
<li>"hidden" # 仅对本单元可见
</li>
</ul>

<p>然后我们还能够通过编译选项-fvisibility来控制可见域默认值。
</p>
</div>

</div>

<div id="outline-container-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Explicit Inlining</h3>
<div class="outline-text-3" id="text-1-5">

<p>inline __attribute_<sub>((always_inline))</sub> 可以强制inline.
</p>
</div>

</div>

<div id="outline-container-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Vector Extensions</h3>
<div class="outline-text-3" id="text-1-6">

<p>通常编译器都会提供对应的头文件（提供指令以及数据类型）
</p><ul>
<li>x86: x86intrin.h
</li>
<li>MMX: mmintrin.h
</li>
<li>SSE: xmmintrin.h
</li>
<li>SSE2: emmintrin.h
</li>
<li>SSE3: mm3dnow.h
</li>
<li>3dnow: tmmintrin.h
</li>
<li>AVX: immintrin.h
</li>
</ul>


<p>
SIMD指令操作参数通常要求字节对齐（比如16字节），头文件里面应该都会定义这些数据类型
</p>


<pre class="example">/* SSE2 */
typedef double __v2df __attribute__ ((__vector_size__ (16)));
typedef long long __v2di __attribute__ ((__vector_size__ (16)));
typedef int __v4si __attribute__ ((__vector_size__ (16)));
typedef short __v8hi __attribute__ ((__vector_size__ (16)));
typedef char __v16qi __attribute__ ((__vector_size__ (16)));
</pre>


</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2014-10-12T22:43+0800</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.3f with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 24</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
<!-- Baidu Analytics BEGIN --><script type="text/javascript">var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F54a700ad7035f6e485eaf2300641e7e9' type='text/javascript'%3E%3C/script%3E"));</script><!-- Baidu Analytics END --><!-- Google Analytics BEGIN --><!-- <script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-31377772-1']);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script> --><!-- Google Analytics END --><!-- Baidu Button BEGIN --><!-- <script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=6762177" ></script><script type="text/javascript" id="bdshell_js"></script><script type="text/javascript"> document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)</script> --><!-- Baidu Button END --><!-- G+ BEGIN --><!-- Place this render call where appropriate --><!-- <script type="text/javascript">  (function() {    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;    po.src = 'https://apis.google.com/js/plusone.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);  })();</script> --><!-- G+ END --><!-- DISQUS BEGIN --><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * *//* required: replace example with your forum shortname  */var disqus_shortname = 'dirlt';var disqus_identifier = 'guide-to-advanced-programming-in-c.html';var disqus_title = 'guide-to-advanced-programming-in-c.html';var disqus_url = 'http://dirlt.com/guide-to-advanced-programming-in-c.html';/* * * DON'T EDIT BELOW THIS LINE * * */(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a><!-- DISQUS END --></body>
</html>
